#!/usr/bin/env python3
"""
ç¹é«”ä¸­æ–‡ä¿®å¾©å·¥å…· - Traditional Chinese Fixer
æ‰¾å‡ºä¸¦ä¿®å¾©æ‰€æœ‰ç°¡é«”ä¸­æ–‡å­—ç¬¦
"""

import os
import re
from pathlib import Path

# ç°¡é«”è½‰ç¹é«”å°æ‡‰è¡¨
SIMPLIFIED_TO_TRADITIONAL = {
    # å¸¸è¦‹ç°¡é«”å­—è½‰ç¹é«”å­—
    'å˜': 'è®Š',
    'å˜å¾—': 'è®Šå¾—',
    'å˜æˆ': 'è®Šæˆ',
    'å¼€å§‹': 'é–‹å§‹',
    'è¿™æ ·': 'é€™æ¨£',
    'æ²¡æœ‰': 'æ²’æœ‰',
    'è¿˜æ˜¯': 'é‚„æ˜¯',
    'åº”è¯¥': 'æ‡‰è©²',
    'å¬è¯´': 'è½èªª',
    'æ€ä¹ˆ': 'æ€éº¼',
    'å‘ç°': 'ç™¼ç¾',
    'å…³ç³»': 'é—œä¿‚',
    'å­¦ä¹ ': 'å­¸ç¿’',
    'å­¦ä¸š': 'å­¸æ¥­',
    'è¯»ä¹¦': 'è®€æ›¸',
    'è¯»': 'è®€',
    'å¤„ç†': 'è™•ç†',
    'è®²è¯': 'è¬›è©±',
    'è®²å¾—': 'è¬›å¾—',
    'è¯´è¯': 'èªªè©±',
    'è¯´': 'èªª',
    'è¿‡': 'é',
    'è¿‡ç¨‹': 'éç¨‹',
    'ç»è¿‡': 'ç¶“é',
    'æ—¶é—´': 'æ™‚é–“',
    'æ—¶å€™': 'æ™‚å€™',
    'åƒäº†': 'é£Ÿå’—',
    'åƒäº†æ²¡': 'é£Ÿå’—é£¯æœª',
    'åƒäº†æ²’': 'é£Ÿå’—é£¯æœª',
    'æ™šå®‰': 'good night',  # æ›´é¦™æ¸¯åŒ–
    'è®²': 'è¬›',
    'è°ˆ': 'è«‡',
    'è°ˆè¯': 'è«‡è©±',
    'è¯´æ˜': 'èªªæ˜',
    'è§£é‡Š': 'è§£é‡‹',
    'è®¤è¯†': 'èªè­˜',
    'è®¤ä¸º': 'èªç‚º',
    'è§‰å¾—': 'è¦ºå¾—',
    'é—®é¢˜': 'å•é¡Œ',
    'é—®': 'å•',
    'å¬': 'è½',
    'è§': 'è¦‹',
    'çœ‹è§': 'çœ‹è¦‹',
    'å‘ç”Ÿ': 'ç™¼ç”Ÿ',
    'å‘å±•': 'ç™¼å±•',
    'å‘è§‰': 'ç™¼è¦º',
    'å‘ç°': 'ç™¼ç¾',
    'è®¡åˆ’': 'è¨ˆåŠƒ',
    'è®¡': 'è¨ˆ',
    'è®©': 'è®“',
    'è®©äºº': 'è®“äºº',
    'ç»™': 'çµ¦',
    'ç»™ä½ ': 'ä¿¾ä½ ',
    'ç»™æˆ‘': 'ä¿¾æˆ‘',
    'ç»™ä»–': 'ä¿¾ä½¢',
    'ç»™å¥¹': 'ä¿¾ä½¢',
    'å¯¹': 'å°',
    'å¯¹äº': 'å°æ–¼',
    'å¯¹ä¸èµ·': 'å°å””ä½',
    'è°¢è°¢': 'å¤šè¬',
    'å†è§': 'å†è¦‹',
    'æ¬¢è¿': 'æ­¡è¿',
    'ç”µè¯': 'é›»è©±',
    'ç”µè„‘': 'é›»è…¦',
    'ç”µ': 'é›»',
    'ä¹°': 'è²·',
    'å–': 'è³£',
    'é’±': 'éŒ¢',
    'æŒ£é’±': 'æµéŒ¢',
    'èµšé’±': 'æµéŒ¢',
    'å·¥ä½œ': 'å·¥ä½œ',
    'å­¦æ ¡': 'å­¸æ ¡',
    'è€å¸ˆ': 'è€å¸«',
    'å­¦ç”Ÿ': 'å­¸ç”Ÿ',
    'æœ‹å‹': 'æœ‹å‹',
    'çˆ±æƒ…': 'æ„›æƒ…',
    'çˆ±': 'æ„›',
    'å–œæ¬¢': 'é¾æ„',
    'å–œ': 'å–œ',
    'æ¬¢': 'æ­¡',
    'ä¹': 'æ¨‚',
    'å¿«ä¹': 'å¿«æ¨‚',
    'é«˜å…´': 'é«˜èˆˆ',
    'å¼€å¿ƒ': 'é–‹å¿ƒ',
    'æ‹…å¿ƒ': 'æ“”å¿ƒ',
    'ç´§å¼ ': 'ç·Šå¼µ',
    'å‹åŠ›': 'å£“åŠ›',
    'çƒ¦æ¼': 'ç…©æƒ±',
    'çƒ¦': 'ç…©',
    'éš¾': 'é›£',
    'éš¾è¿‡': 'é›£é',
    'ç®€å•': 'ç°¡å–®',
    'å¤æ‚': 'è¤‡é›œ',
    'å¤': 'å¾©',
    'æŠ¥å‘Š': 'å ±å‘Š',
    'æŠ¥': 'å ±',
    'å†™': 'å¯«',
    'å†™ä½œ': 'å¯«ä½œ',
    'é˜…è¯»': 'é–±è®€',
    'è¯»': 'è®€',
    'çœ‹': 'ç‡',
    'è§‚çœ‹': 'è§€çœ‹',
    'è§‚': 'è§€',
    'å¬': 'è½',
    'è¯´': 'è¬›',
    'è®²': 'è¬›',
}

def fix_traditional_chinese_in_file(file_path):
    """ä¿®å¾©æª”æ¡ˆä¸­çš„ç°¡é«”å­—"""
    try:
        with open(file_path, 'r', encoding='utf-8') as f:
            content = f.read()
        
        original_content = content
        
        # é€å€‹æ›¿æ›ç°¡é«”å­—
        for simplified, traditional in SIMPLIFIED_TO_TRADITIONAL.items():
            content = content.replace(simplified, traditional)
        
        # å¦‚æœæœ‰è®Šæ›´ï¼Œå¯«å›æª”æ¡ˆ
        if content != original_content:
            with open(file_path, 'w', encoding='utf-8') as f:
                f.write(content)
            return True
        
        return False
        
    except Exception as e:
        print(f"âŒ è™•ç†æª”æ¡ˆ {file_path} æ™‚å‡ºéŒ¯ï¼š{e}")
        return False

def scan_and_fix_directory(directory):
    """æƒæç›®éŒ„ä¸¦ä¿®å¾©æ‰€æœ‰æª”æ¡ˆ"""
    fixed_files = []
    
    # è¦è™•ç†çš„æª”æ¡ˆé¡å‹
    file_extensions = ['.py', '.txt', '.md', '.json']
    
    for root, dirs, files in os.walk(directory):
        # è·³éä¸€äº›ä¸éœ€è¦è™•ç†çš„ç›®éŒ„
        dirs[:] = [d for d in dirs if not d.startswith('.') and d != '__pycache__']
        
        for file in files:
            file_path = os.path.join(root, file)
            
            # æª¢æŸ¥æª”æ¡ˆå‰¯æª”å
            if any(file.endswith(ext) for ext in file_extensions):
                if fix_traditional_chinese_in_file(file_path):
                    fixed_files.append(file_path)
    
    return fixed_files

def main():
    """ä¸»å‡½æ•¸"""
    print("=== ğŸ‡­ğŸ‡° ç¹é«”ä¸­æ–‡ä¿®å¾©å·¥å…· ===")
    print("æ­£åœ¨æƒæä¸¦ä¿®å¾©ç°¡é«”ä¸­æ–‡å­—ç¬¦...\n")
    
    # æƒæç•¶å‰ç›®éŒ„
    current_dir = '.'
    fixed_files = scan_and_fix_directory(current_dir)
    
    if fixed_files:
        print(f"âœ… å·²ä¿®å¾© {len(fixed_files)} å€‹æª”æ¡ˆï¼š")
        for file_path in fixed_files:
            print(f"   ğŸ“ {file_path}")
    else:
        print("âœ… æ‰€æœ‰æª”æ¡ˆå·²ç¶“æ˜¯æ­£ç¢ºçš„ç¹é«”ä¸­æ–‡ï¼")
    
    print("\nğŸ‰ ç¹é«”ä¸­æ–‡ä¿®å¾©å®Œæˆï¼")
    
    # æª¢æŸ¥å¸¸è¦‹å•é¡Œå­—ç¬¦
    print("\n=== ğŸ“‹ å¸¸è¦‹è½‰æ›å°æ‡‰è¡¨ ===")
    key_conversions = {
        'å˜å¾—': 'è®Šå¾—',
        'å‘ç°': 'ç™¼ç¾',
        'å…³ç³»': 'é—œä¿‚',
        'å­¦ä¸š': 'å­¸æ¥­',
        'å¤„ç†': 'è™•ç†',
        'åƒäº†æ²¡': 'é£Ÿå’—é£¯æœª',
        'æ™šå®‰': 'good night',
        'ç»™ä½ ': 'ä¿¾ä½ ',
        'å¯¹ä¸èµ·': 'å°å””ä½',
        'è°¢è°¢': 'å¤šè¬',
        'å–œæ¬¢': 'é¾æ„',
        'çœ‹': 'ç‡',
        'è¯´': 'è¬›'
    }
    
    for simplified, traditional in key_conversions.items():
        print(f"   {simplified} â†’ {traditional}")

if __name__ == "__main__":
    main() 